<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>501st Clone Trooper - –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä—â–∏–∫</title>
    <style>
        /* CSS —Å—Ç–∏–ª–∏ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a5fb4;
            --secondary: #26a269;
            --accent: #e5a50a;
            --dark: #1e1e1e;
            --light: #f6f5f4;
            --gray: #deddda;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            color: var(--light);
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(30, 30, 30, 0.8);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #4a90e2, #63b3ed);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .subtitle {
            font-size: 1.1rem;
            color: #a0a0a0;
            font-weight: 300;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –º–æ–¥–µ–ª–∏ */
        .model-container {
            background: rgba(25, 25, 25, 0.9);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            border: 2px solid rgba(74, 144, 226, 0.3);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
        }

        .sketchfab-embed {
            width: 100%;
            height: 500px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            background: #000;
        }

        .sketchfab-embed iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª—å—é */
        .model-controls {
            padding: 20px;
            background: rgba(40, 40, 40, 0.7);
            border-radius: 10px;
        }

        .control-group {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }

        .btn.primary {
            background: linear-gradient(135deg, var(--primary), #3d7eff);
            color: white;
        }

        .btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 7px 20px rgba(58, 119, 255, 0.4);
        }

        .btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .btn.secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–π */
        .sequence-info {
            margin-top: 20px;
        }

        .sequence-steps {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .step {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid var(--accent);
            transition: all 0.3s;
            cursor: pointer;
            color: white;
        }

        .step:hover {
            background: rgba(74, 144, 226, 0.2);
            transform: translateX(5px);
        }

        .step.active {
            background: rgba(74, 144, 226, 0.4);
            border-left-color: var(--primary);
            font-weight: bold;
        }

        /* –ü–∞–Ω–µ–ª—å –∞–Ω–∏–º–∞—Ü–∏–π */
        .animations-panel {
            background: rgba(30, 30, 30, 0.9);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .animations-panel h2 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--light);
        }

        .animations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }

        .anim-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--light);
            text-align: center;
        }

        .anim-btn:hover {
            background: rgba(74, 144, 226, 0.2);
            border-color: var(--primary);
            transform: translateY(-3px);
        }

        .anim-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
            box-shadow: 0 5px 15px rgba(74, 144, 226, 0.4);
        }

        /* –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ */
        .animation-controls {
            background: rgba(0, 0, 0, 0.3);
            padding: 20px;
            border-radius: 10px;
        }

        .control-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
            justify-content: center;
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .control-btn.play {
            background: var(--secondary);
        }

        .control-btn.play:hover {
            background: #2ecc71;
        }

        .timeline-control {
            text-align: center;
        }

        .timeline-control label {
            display: block;
            margin-bottom: 10px;
            font-weight: 500;
        }

        #speed-slider {
            width: 100%;
            height: 6px;
            -webkit-appearance: none;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            outline: none;
        }

        #speed-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            background: var(--primary);
            border-radius: 50%;
            cursor: pointer;
        }

        /* –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç—É—Å–∞ */
        .status-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .status-item {
            background: rgba(30, 30, 30, 0.9);
            padding: 20px;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .status-label {
            color: #a0a0a0;
            font-size: 0.9rem;
        }

        .status-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: var(--accent);
        }

        .status-value.idle { color: #3498db; }
        .status-value.playing { color: #2ecc71; }
        .status-value.paused { color: #f39c12; }

        .progress-container {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 5px;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            width: 0%;
            transition: width 0.3s;
        }

        /* –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è –ø–∞–Ω–µ–ª—å */
        .info-panel {
            background: rgba(30, 30, 30, 0.9);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border-left: 5px solid var(--accent);
        }

        .info-panel h3 {
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-content p {
            margin-bottom: 10px;
            padding-left: 10px;
            border-left: 2px solid rgba(74, 144, 226, 0.5);
            padding: 10px 0 10px 15px;
        }

        /* –§—É—Ç–µ—Ä */
        footer {
            text-align: center;
            padding: 25px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            font-size: 0.9rem;
            color: #888;
        }

        footer a {
            color: var(--accent);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* –ò–∫–æ–Ω–∫–∏ */
        .icon {
            font-size: 1.2em;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .sketchfab-embed {
                height: 400px;
            }
            
            .control-buttons {
                flex-direction: column;
            }
            
            .control-btn {
                width: 100%;
            }
            
            .animations-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .sequence-steps {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .animations-grid {
                grid-template-columns: 1fr;
            }
            
            .status-panel {
                grid-template-columns: 1fr;
            }
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/FBXLoader.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>‚ö° 501st Clone Trooper Phase II</h1>
            <p class="subtitle">–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —à—Ç—É—Ä–º–æ–≤–∏–∫ 501-–≥–æ –ª–µ–≥–∏–æ–Ω–∞</p>
        </header>

        <main>
            <!-- Sketchfab –º–æ–¥–µ–ª—å -->
            <div class="model-container">
                <div id="sketchfab-embed" class="sketchfab-embed">
                    <!-- Sketchfab iframe –±—É–¥–µ—Ç –≤—Å—Ç–∞–≤–ª–µ–Ω —Å—é–¥–∞ -->
                </div>
                <div class="model-controls">
                    <div class="control-group">
                        <button id="play-sequence" class="btn primary">
                            <span class="icon">‚ñ∂Ô∏è</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
                        </button>
                        <button id="stop-all" class="btn secondary">
                            <span class="icon">‚èπÔ∏è</span> –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
                        </button>
                    </div>
                    
                    <div class="sequence-info">
                        <h3>–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–π:</h3>
                        <div class="sequence-steps">
                            <div class="step" data-anim="idle">1. –°—Ç–æ–π–∫–∞ (Idle)</div>
                            <div class="step" data-anim="up">2. –ü–æ–¥—ä–µ–º (Up)</div>
                            <div class="step" data-anim="fire">3. –°—Ç—Ä–µ–ª—å–±–∞ (Fire)</div>
                            <div class="step" data-anim="down">4. –ü—Ä–∏—Å–µ–¥ (Down)</div>
                            <div class="step" data-anim="death">5. –°–º–µ—Ä—Ç—å (Death)</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –õ–æ–∫–∞–ª—å–Ω—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ -->
            <div class="animations-panel">
                <h2><span class="icon">üé¨</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏</h2>
                
                <div class="animations-grid" id="animations-list">
                    <!-- –ê–Ω–∏–º–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <div class="animation-controls">
                    <div class="control-buttons">
                        <button id="prev-anim" class="control-btn">
                            <span class="icon">‚èÆÔ∏è</span> –ù–∞–∑–∞–¥
                        </button>
                        <button id="play-anim" class="control-btn play">
                            <span class="icon">‚ñ∂Ô∏è</span> –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏
                        </button>
                        <button id="pause-anim" class="control-btn">
                            <span class="icon">‚è∏Ô∏è</span> –ü–∞—É–∑–∞
                        </button>
                        <button id="next-anim" class="control-btn">
                            <span class="icon">‚è≠Ô∏è</span> –í–ø–µ—Ä–µ–¥
                        </button>
                    </div>
                    
                    <div class="timeline-control">
                        <label>–°–∫–æ—Ä–æ—Å—Ç—å: <span id="speed-value">1.0x</span></label>
                        <input type="range" id="speed-slider" min="0.1" max="3" step="0.1" value="1">
                    </div>
                </div>
            </div>

            <!-- –°—Ç–∞—Ç—É—Å –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è -->
            <div class="status-panel">
                <div class="status-item">
                    <span class="status-label">–¢–µ–∫—É—â–∞—è –∞–Ω–∏–º–∞—Ü–∏—è:</span>
                    <span id="current-anim" class="status-value">Idle</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–°—Ç–∞—Ç—É—Å:</span>
                    <span id="anim-status" class="status-value idle">–û–∂–∏–¥–∞–Ω–∏–µ</span>
                </div>
                <div class="status-item">
                    <span class="status-label">–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
                    <div class="progress-container">
                        <div class="progress-bar" id="progress-bar"></div>
                    </div>
                </div>
            </div>

            <div class="info-panel">
                <h3><span class="icon">‚ÑπÔ∏è</span> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                <div class="info-content">
                    <p><strong>–ú–æ–¥–µ–ª—å:</strong> –í—Å—Ç—Ä–æ–µ–Ω–∞ —Å Sketchfab (—Ä–∞–±–æ—Ç–∞–µ—Ç –æ–Ω–ª–∞–π–Ω)</p>
                    <p><strong>–ê–Ω–∏–º–∞—Ü–∏–∏:</strong> –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –∏–∑ –ø–∞–ø–∫–∏ Anims/</p>
                    <p><strong>–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</strong> –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ 5 –∞–Ω–∏–º–∞—Ü–∏–π –ø–æ –ø–æ—Ä—è–¥–∫—É</p>
                    <p><strong>–§–æ—Ä–º–∞—Ç –∞–Ω–∏–º–∞—Ü–∏–π:</strong> FBX —Ñ–∞–π–ª—ã (Idle.fbx, Up.fbx –∏ —Ç.–¥.)</p>
                </div>
            </div>
        </main>

        <footer>
            <p>–ú–æ–¥–µ–ª—å: <a href="https://skfb.ly/68CZ6" target="_blank">Clone Trooper 501st Legion –Ω–∞ Sketchfab</a></p>
            <p>–ê–Ω–∏–º–∞—Ü–∏–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Three.js –¥–ª—è –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–π</p>
        </footer>
    </div>

    <script>
        // JavaScript –∫–æ–¥
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
        const ANIMATION_SEQUENCE = ['idle', 'up', 'fire', 'down', 'death'];
        const ANIMATION_PATHS = {
            'idle': 'Anims/Idle.fbx',
            'up': 'Anims/Up.fbx',
            'fire': 'Anims/Fire.fbx',
            'down': 'Anims/Down.fbx',
            'death': 'Anims/Death.fbx'
        };

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let currentState = {
            currentAnimIndex: 0,
            isPlayingSequence: false,
            isPlayingSingle: false,
            animationSpeed: 1.0,
            animationsLoaded: false,
            sketchfabAPI: null
        };

        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        let animMixer = null;
        let currentAction = null;
        let animClock = new THREE.Clock();

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            // 1. –í—Å—Ç—Ä–∞–∏–≤–∞–µ–º –º–æ–¥–µ–ª—å Sketchfab
            embedSketchfabModel();
            
            // 2. –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏
            loadAnimations();
            
            // 3. –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
            setupEventListeners();
            
            // 4. –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–∏–∫–ª
            animate();
        });

        // –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ Sketchfab
        function embedSketchfabModel() {
            const embedContainer = document.getElementById('sketchfab-embed');
            
            const iframe = document.createElement('iframe');
            iframe.title = "Clone Trooper 501st Legion (OLD)";
            iframe.frameBorder = "0";
            iframe.allowFullscreen = true;
            iframe.mozallowfullscreen = true;
            iframe.webkitallowfullscreen = true;
            iframe.allow = "autoplay; fullscreen; xr-spatial-tracking";
            iframe.xrSpatialTracking = true;
            iframe.executionWhileOutOfViewport = true;
            iframe.executionWhileNotRendered = true;
            iframe.webShare = true;
            iframe.width = "100%";
            iframe.height = "500";
            iframe.src = "https://sketchfab.com/models/46a00518f88c4e9b9a4516954d9dd491/embed?autostart=1&ui_controls=1&ui_infos=1";
            
            embedContainer.appendChild(iframe);
            
            // –ñ–¥–µ–º –∑–∞–≥—Ä—É–∑–∫–∏ Sketchfab
            iframe.addEventListener('load', () => {
                console.log('Sketchfab –º–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
                updateStatus('–ú–æ–¥–µ–ª—å –∑–∞–≥—Ä—É–∂–µ–Ω–∞', 'idle');
            });
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–π
        function loadAnimations() {
            // –°–æ–∑–¥–∞–µ–º —Å—Ü–µ–Ω—É –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π (–Ω–µ–≤–∏–¥–∏–º—É—é)
            const scene = new THREE.Scene();
            animMixer = new THREE.AnimationMixer(scene);
            
            // –°–æ–∑–¥–∞–µ–º –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
            createAnimationButtons();
            
            currentState.animationsLoaded = true;
            updateStatus('–ê–Ω–∏–º–∞—Ü–∏–∏ –≥–æ—Ç–æ–≤—ã', 'idle');
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–Ω–æ–ø–æ–∫ –∞–Ω–∏–º–∞—Ü–∏–π
        function createAnimationButtons() {
            const container = document.getElementById('animations-list');
            
            ANIMATION_SEQUENCE.forEach((animName, index) => {
                const button = document.createElement('button');
                button.className = 'anim-btn';
                button.dataset.anim = animName;
                button.dataset.index = index;
                
                // –ò–∫–æ–Ω–∫–∞ –¥–ª—è —Ç–∏–ø–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
                let icon = 'üé¨';
                if (animName === 'idle') icon = 'üßç';
                if (animName === 'up') icon = '‚¨ÜÔ∏è';
                if (animName === 'fire') icon = 'üî´';
                if (animName === 'down') icon = '‚¨áÔ∏è';
                if (animName === 'death') icon = 'üíÄ';
                
                button.innerHTML = `
                    <span class="icon">${icon}</span>
                    <span>${animName.toUpperCase()}</span>
                `;
                
                button.onclick = () => playSingleAnimation(animName);
                container.appendChild(button);
            });
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–µ—Ä–≤—É—é –∫–Ω–æ–ø–∫—É
            activateAnimationButton(0);
        }

        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –æ–¥–∏–Ω–æ—á–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
        function playSingleAnimation(animName) {
            if (!currentState.animationsLoaded) return;
            
            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –µ—Å–ª–∏ –∏–≥—Ä–∞–µ—Ç
            if (currentState.isPlayingSequence) {
                stopSequence();
            }
            
            // –ù–∞—Ö–æ–¥–∏–º –∏–Ω–¥–µ–∫—Å –∞–Ω–∏–º–∞—Ü–∏–∏
            const animIndex = ANIMATION_SEQUENCE.indexOf(animName);
            if (animIndex === -1) return;
            
            currentState.currentAnimIndex = animIndex;
            activateAnimationButton(animIndex);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.getElementById('current-anim').textContent = 
                animName.charAt(0).toUpperCase() + animName.slice(1);
            updateStatus('–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ', 'playing');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
            loadAndPlayAnimation(animName);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏ –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏
        function loadAndPlayAnimation(animName) {
            const loader = new THREE.FBXLoader();
            const animPath = ANIMATION_PATHS[animName];
            
            if (!animPath) {
                console.error('–ü—É—Ç—å –∫ –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω:', animName);
                simulateAnimation(animName);
                return;
            }
            
            console.log('–ó–∞–≥—Ä—É–∑–∫–∞ –∞–Ω–∏–º–∞—Ü–∏–∏:', animPath);
            
            // –°–æ–∑–¥–∞–µ–º —Ñ–µ–π–∫–æ–≤—É—é –∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è –¥–µ–º–æ (–µ—Å–ª–∏ —Ñ–∞–π–ª—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã)
            simulateAnimation(animName);
            
            // –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —ç—Ç–æ, –µ—Å–ª–∏ —Ñ–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã:
            /*
            loader.load(animPath, (fbx) => {
                if (fbx.animations.length > 0) {
                    // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –∞–Ω–∏–º–∞—Ü–∏—é
                    if (currentAction) {
                        currentAction.stop();
                    }
                    
                    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
                    const clip = fbx.animations[0];
                    currentAction = animMixer.clipAction(clip);
                    currentAction.timeScale = currentState.animationSpeed;
                    currentAction.play();
                    
                    currentState.isPlayingSingle = true;
                    
                    // –°–ª—É—à–∞–µ–º –æ–∫–æ–Ω—á–∞–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏
                    animMixer.addEventListener('finished', () => {
                        if (currentState.isPlayingSingle) {
                            currentState.isPlayingSingle = false;
                            updateStatus('–ó–∞–≤–µ—Ä—à–µ–Ω–æ', 'idle');
                        }
                    });
                }
            }, undefined, (error) => {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–∏:', error);
                simulateAnimation(animName);
            });
            */
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ–º–æ-–∞–Ω–∏–º–∞—Ü–∏–∏
        function simulateAnimation(animName) {
            console.log('–°–æ–∑–¥–∞–µ–º –¥–µ–º–æ-–∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è:', animName);
            
            const duration = getAnimDuration(animName);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
            simulateAnimationProgress(duration);
            
            updateStatus('–î–µ–º–æ-–∞–Ω–∏–º–∞—Ü–∏—è', 'playing');
            currentState.isPlayingSingle = true;
            
            // –ß–µ—Ä–µ–∑ –≤—Ä–µ–º—è "–∑–∞–≤–µ—Ä—à–∞–µ–º" –∞–Ω–∏–º–∞—Ü–∏—é
            setTimeout(() => {
                currentState.isPlayingSingle = false;
                updateStatus('–ó–∞–≤–µ—Ä—à–µ–Ω–æ', 'idle');
                
                // –ï—Å–ª–∏ –∏–≥—Ä–∞–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º
                if (currentState.isPlayingSequence) {
                    setTimeout(() => {
                        if (currentState.isPlayingSequence) {
                            playNextInSequence();
                        }
                    }, 500);
                }
            }, duration * 1000);
        }

        // –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∞–Ω–∏–º–∞—Ü–∏–π
        function getAnimDuration(animName) {
            const durations = {
                'idle': 3,
                'up': 2,
                'fire': 4,
                'down': 2,
                'death': 5
            };
            return durations[animName] || 3;
        }

        // –°–∏–º—É–ª—è—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
        function simulateAnimationProgress(duration) {
            const progressBar = document.getElementById('progress-bar');
            let progress = 0;
            const interval = 100; // ms
            
            const intervalId = setInterval(() => {
                progress += interval / (duration * 1000);
                if (progress >= 1) {
                    progress = 1;
                    clearInterval(intervalId);
                }
                progressBar.style.width = (progress * 100) + '%';
            }, interval);
            
            // –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–π –∞–Ω–∏–º–∞—Ü–∏–∏
            setTimeout(() => {
                clearInterval(intervalId);
            }, duration * 1000);
        }

        // –ó–∞–ø—É—Å–∫ –≤—Å–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function playSequence() {
            if (currentState.isPlayingSequence) return;
            
            currentState.isPlayingSequence = true;
            currentState.currentAnimIndex = 0;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            const playBtn = document.getElementById('play-sequence');
            playBtn.disabled = true;
            playBtn.innerHTML = '<span class="icon">üîÑ</span> –ò–¥–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å...';
            updateStatus('–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å', 'playing');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –ø–µ—Ä–≤—ã–π —à–∞–≥
            activateSequenceStep(0);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –ø–µ—Ä–≤—É—é –∞–Ω–∏–º–∞—Ü–∏—é
            playNextInSequence();
        }

        // –í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Å–ª–µ–¥—É—é—â–µ–π –∞–Ω–∏–º–∞—Ü–∏–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function playNextInSequence() {
            if (!currentState.isPlayingSequence) return;
            
            const animName = ANIMATION_SEQUENCE[currentState.currentAnimIndex];
            playSingleAnimation(animName);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—É—â—É—é –∞–Ω–∏–º–∞—Ü–∏—é
            document.getElementById('current-anim').textContent = 
                animName.charAt(0).toUpperCase() + animName.slice(1);
        }

        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function stopSequence() {
            currentState.isPlayingSequence = false;
            currentState.isPlayingSingle = false;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            const playBtn = document.getElementById('play-sequence');
            playBtn.disabled = false;
            playBtn.innerHTML = '<span class="icon">‚ñ∂Ô∏è</span> –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å';
            
            updateStatus('–û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ', 'idle');
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
            document.getElementById('progress-bar').style.width = '0%';
            
            // –î–µ–∞–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤—Å–µ —à–∞–≥–∏
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
        }

        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —à–∞–≥–∞ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        function activateSequenceStep(index) {
            document.querySelectorAll('.step').forEach(step => {
                step.classList.remove('active');
            });
            
            const step = document.querySelector(`.step[data-anim="${ANIMATION_SEQUENCE[index]}"]`);
            if (step) {
                step.classList.add('active');
            }
        }

        // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –∞–Ω–∏–º–∞—Ü–∏–∏
        function activateAnimationButton(index) {
            document.querySelectorAll('.anim-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const button = document.querySelector(`.anim-btn[data-index="${index}"]`);
            if (button) {
                button.classList.add('active');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
        function updateStatus(text, statusClass) {
            const statusEl = document.getElementById('anim-status');
            statusEl.textContent = text;
            statusEl.className = `status-value ${statusClass}`;
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // –ö–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            document.getElementById('play-sequence').onclick = playSequence;
            
            // –ö–Ω–æ–ø–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏
            document.getElementById('stop-all').onclick = stopSequence;
            
            // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∏–º–∞—Ü–∏—è–º–∏
            document.getElementById('prev-anim').onclick = () => {
                const newIndex = (currentState.currentAnimIndex - 1 + ANIMATION_SEQUENCE.length) % ANIMATION_SEQUENCE.length;
                playSingleAnimation(ANIMATION_SEQUENCE[newIndex]);
            };
            
            document.getElementById('next-anim').onclick = () => {
                const newIndex = (currentState.currentAnimIndex + 1) % ANIMATION_SEQUENCE.length;
                playSingleAnimation(ANIMATION_SEQUENCE[newIndex]);
            };
            
            document.getElementById('play-anim').onclick = () => {
                const currentAnim = ANIMATION_SEQUENCE[currentState.currentAnimIndex];
                playSingleAnimation(currentAnim);
            };
            
            document.getElementById('pause-anim').onclick = () => {
                updateStatus('–ù–∞ –ø–∞—É–∑–µ', 'paused');
                // –í –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ–º —Å—Ç–∞—Ç—É—Å
            };
            
            // –°–ª–∞–π–¥–µ—Ä —Å–∫–æ—Ä–æ—Å—Ç–∏
            const speedSlider = document.getElementById('speed-slider');
            const speedValue = document.getElementById('speed-value');
            
            speedSlider.oninput = (e) => {
                const speed = parseFloat(e.target.value);
                currentState.animationSpeed = speed;
                speedValue.textContent = speed.toFixed(1) + 'x';
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ –æ–±–Ω–æ–≤–ª—è–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏
                if (currentAction) {
                    currentAction.timeScale = speed;
                }
            };
            
            // –ö–ª–∏–∫ –ø–æ —à–∞–≥–∞–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            document.querySelectorAll('.step').forEach(step => {
                step.onclick = () => {
                    const animName = step.dataset.anim;
                    playSingleAnimation(animName);
                };
            });
            
            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            setInterval(() => {
                if (currentState.isPlayingSequence && !currentState.isPlayingSingle) {
                    currentState.currentAnimIndex++;
                    
                    if (currentState.currentAnimIndex < ANIMATION_SEQUENCE.length) {
                        // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥
                        activateSequenceStep(currentState.currentAnimIndex);
                        // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∞–Ω–∏–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –ø–∞—É–∑—É
                        setTimeout(() => {
                            if (currentState.isPlayingSequence) {
                                playNextInSequence();
                            }
                        }, 500);
                    } else {
                        // –ö–æ–Ω–µ—Ü –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                        stopSequence();
                    }
                }
            }, 100);
        }

        // –ê–Ω–∏–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ü–∏–∫–ª
        function animate() {
            requestAnimationFrame(animate);
            
            const delta = animClock.getDelta();
            
            if (animMixer) {
                animMixer.update(delta);
            }
        }
    </script>
</body>
</html>
